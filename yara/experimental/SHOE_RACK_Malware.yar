rule SHOE_RACK_Malware
{
    meta:
        description = "Detects SHOE RACK reverse SSH malware"
        author = "Cyber Graf"
        version = "1.1"
        reference = "NCSC Advisory June 2025"
        license = "CC BY 4.0"
        hash1 = "5c5843ae833cab1417a0ac992b5007fce40158fc3afec4c6e4fd0e932de07177"
        hash2 = "d86d360f51550feccfd92f0e04891591ab9b0c049eacd07d49460f6b3d7764bf"

    strings:
        $go1 = "github.com/pkg/sftp.NewServer" ascii
        $go2 = "golang.org/x/crypto/ssh.NewClientConn" ascii
        $ver = "SSH-1.1.3" ascii
        $dns = "phcia.duckdns.org" ascii

    condition:
        uint16(0) == 0x5A4D and 2 of ($go*) and $dns
}
rule NailaoLocker_UPX_Golang_Obfuscated
{
    meta:
        description = "Detects UPX-packed NailaoLocker Golang ransomware with file encryption behavior"
        author = "Cyber Graf"
        version = "1.0"
        license = "CC BY 4.0"

    strings:
        $walk = "filepath.Walk(" ascii
        $out = "os.Create(" ascii
        $upx = "UPX!" ascii
        $ext2 = ".cheese" ascii

    condition:
        uint16(0) == 0x5A4D and all of them
}
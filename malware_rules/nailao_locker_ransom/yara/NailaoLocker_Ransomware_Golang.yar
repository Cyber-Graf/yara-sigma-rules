rule NailaoLocker_Ransomware_Golang
{
    meta:
        description = "Detects Golang-built NailaoLocker ransomware sample"
        author = "Cyber Graf"
        reference = "FortiGuard Labs, 2025"
        version = "1.0"
        license = "CC BY 4.0"
        threat_name = "NailaoLocker"

    strings:
        $ext = ".cheese" ascii
        $note = "README.txt" ascii
        $alg = "xchacha20-poly1305" ascii
        $rsa = "BEGIN RSA PUBLIC KEY" ascii
        $ascii = "             (__)        " ascii // ASCII-сыр из ransom note

    condition:
        uint16(0) == 0x5A4D and 2 of ($ext, $note, $alg, $rsa, $ascii)
}
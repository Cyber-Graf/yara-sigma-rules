rule ThrottleStop_memory_access_strings
{
    meta:
        description = "Detects kernel memory access strings from ThrottleStop exploited in MedusaLocker attacks"
        author = "Cyber Graf"
        reference = "Kaspersky Securelist - Exploitation of ThrottleStop driver"
        version = "1.0"
        license = "CC BY 4.0"
        threat_name = "MedusaLocker"

    strings:
        $s1 = "ZwOpenProcess" ascii
        $s2 = "ZwTerminateProcess" ascii
        $s3 = "SeDebugPrivilege" ascii

    condition:
        uint16(0) == 0x5A4D and any of ($s*)
}
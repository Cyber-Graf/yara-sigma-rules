rule SLOW_TEMPEST_DynamicJump_Dispatcher
{
    meta:
        author = "Cyber Graf"
        description = "Detects SLOW#TEMPEST loader using dispatcher-based JMP RAX control flow obfuscation"
        license = "CC BY 4.0"
        status = "experimental"
        reference = "https://unit42.paloaltonetworks.com/slow-tempest-malware-obfuscation/"

    strings:
        $cmovnz = { 0F 45 ?? }    // CMOVNZ reg, reg/mem
        $setnl  = { 0F 9D ?? }    // SETNL reg
        $jmp_rax = { FF E0 }      // JMP RAX

    condition:
        uint16(0) == 0x5A4D and
        filesize < 10MB and
        (1 of ($cmovnz, $setnl)) and $jmp_rax
}
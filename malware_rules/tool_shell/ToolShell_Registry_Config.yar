rule ToolShell_Registry_Config
{
    meta:
        description = "Detects registry-related strings in ToolShell RAT"
        author = "Cyber Graf"
        version = "1.0"
        license = "CC BY 4.0"

    strings:
        $r1 = "Software\\Microsoft\\Windows\\CurrentVersion\\Run" ascii
        $r2 = "Software\\ToolShell" ascii
        $s1 = "sc.exe create ToolShell" ascii
        $cmd = "cmd.exe /c start ToolShell.exe" ascii

    condition:
        uint16(0) == 0x5A4D and 2 of ($r1, $r2, $s1, $cmd)
}
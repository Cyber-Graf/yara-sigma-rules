rule cobalt_loader_github_xor
{
    meta:
        description = "Beacon loader using GitHub profile and XOR-encrypted shellcode"
        author = "Cyber Graf"
        reference = "Cobalt Strike Beacon через GitHub и соцсети, Лаборатория Касперского"
        version = "1.0"
        license = "CC BY 4.0"
        threat_name = "CobaltStrike"

    strings:
        $url = "raw.githubusercontent.com/Mariew14/kong/master/spec/fixtures/verify-prs"
        $xor_pattern = { 33 ?? 8B ?? 33 ?? 8B ?? }
        $exe_name = "nau.exe"
        $dll_fake = "Company.pdf"

    condition:
        uint16(0) == 0x5A4D and $url and $xor_pattern and 1 of ($exe_name, $dll_fake)
}
